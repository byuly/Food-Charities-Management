<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="styles.css">
<head>
    <meta charset="UTF-8">
    <!-- This meta tag ensures that the website renders correctly across different device sizes, enhancing mobile responsiveness. -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Link to the external CSS stylesheet. Uncomment if you wish to customize or add styling. -->
    <!-- <link rel="stylesheet" href="styles.css">   -->

    <title>Database Application</title>
</head>
<body>
<h1>Database Connection Status:
    <!-- An in-line placeholder to display connection status. -->
    <span id="dbStatus"> </span>
    <!-- A loading GIF, will be hided once get the status. -->
    <img id="loadingGif" class="loading-gif" src="loading_100px.gif" alt="Loading...">
</h1>

<br><hr><br> <!-- ========================================================================= -->

<!-- Show 'Demotable'.
    Data will be fetched and inserted here dynamically using JavaScript. -->
<h2>Show Tables</h2>
<table id="demotable" border="1">
    <thead>
    <tr>
        <!--Table head, need to be adjusted accordingly to align with your own.-->
        <th>CharityID</th>
        <th>Address</th>
        <th>Name</th>
    </tr>
    </thead>
    <tbody id = 'charitiestable'>
    </tbody>
</table>


<br><hr><br> <!-- ========================================================================= -->

<h2>Reset Demotable</h2>
<p>If you wish to reset the table press on the reset button. If this is the first time you're running this page, you MUST use reset</p>
<button id="resetDemotable"> reset </button> <br>
<!-- A placeholder to display messages related to the reset operation. -->
<div id="resetResultMsg"></div>

<br><hr><br> <!-- ========================================================================= -->

<h2> Insert Values into Charities </h2>
<form id="insertDemotable">
    ID: <input type="number" id="insertId" placeholder="Enter ID" required> <br><br>
    Address: <input type="text" id="insertAddress" placeholder="Enter Address" required> <br><br>
    Name: <input type="text" id="insertName" placeholder="Enter Name" maxlength="20"> <br><br>

    <button type="submit"> insert </button> <br>
</form>
<p id='insertResultMsg'></p>

<br><hr><br>

<h2>Recipient Table</h2>
<table id="recipientstable" border="1">
    <thead>
    <tr>
        <th>SinNum</th>
        <th>EventID</th>
        <th>Age</th>
        <th>ContactNum</th>
        <th>Gender</th>
    </tr>
    </thead>
    <tbody id="recipients-body">
    </tbody>
</table>

<!--INSERT recipient with eventID 1-6, (other eventID does not exist)-->
<h2>Insert Recipient</h2>
<form id="insertRecipientForm">
    Sin Number: <input type="text" id="sinNumber" placeholder="Enter SIN (9 digits)" pattern="\d{9}" required> <br><br>
    Event ID: <input type="number" id="eventId" placeholder="Enter Event ID" required> <br><br>
    Age: <input type="number" id="age" placeholder="Enter Age" min="0" required> <br><br>
    Contact Number: <input type="text" id="contactNumber" placeholder="Enter Contact Number" maxlength="15" required> <br><br>
    Gender:
    <select id="gender">
        <option value="">Select Gender</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
        <option value="Other">Other</option>
    </select>
    <br><br>
    <button type="submit">Insert</button>
</form>
<p id='insertRecipientMsg'></p>


<br><hr><br>
<! -- UPDATE but DONOT change recipient with eventID 5! (for join query) -->
<h2>Update Recipients</h2>
<table id="recipientstable2" border="1">
    <thead>
    <tr>
        <!--Table head, need to be adjusted accordingly to align with your own.-->
        <th>SinNum</th>
        <th>EventID</th>
        <th>Age</th>
        <th>ContactNum</th>
        <th>Gender</th>
    </tr>
    </thead>
    <tbody id="recipients-body2">
    </tbody>
</table>
<p>The values are case sensitive and if you enter in the wrong case, the update statement will not do anything.</p>
<form id="updateRecipient">
    <h3>Update Recipient</h3>

    SIN Number (Required):
    <input type="text" id="updateSinNum" placeholder="Enter SIN Number" required>
    <br><br>

    Event ID:
    <input type="text" id="updateEventID" placeholder="Event ID (optional)">
    <br><br>

    Age:
    <input type="number" id="updateAge" placeholder="Age (optional)" min="0">
    <br><br>

    Contact Number:
    <input type="tel" id="updateContactNum" placeholder="Contact Number (optional)">
    <br><br>

    Gender:
    <select id="updateGender">
        <option value="">Select Gender (optional)</option>
        <option value="Male">Male</option>
        <option value="Female">Female</option>
        <option value="Other">Other</option>
    </select>
    <br><br>

    <button type="submit">Update Recipient</button>
</form>

<div id="updateRecipientResultMsg"></div>

<br><hr><br> <!-- ========================================================================= -->
<h2>Food Donors Table</h2>
<table id="fooddonor" border="1">
    <thead>
    <tr>
        <th>Donor ID</th>
        <th>Name</th>
        <th>Type</th>
        <th>Receipt Number</th>
    </tr>
    </thead>
    <tbody id='fooddonorstable'>
    </tbody>
</table>

<h2> Delete Food Donors </h2>
<form id="deleteFoodDonor">
    Donor ID: <input type="number" id="deleteDonorID" placeholder="Enter Donor ID" required> <br><br>
    <button type="submit" id="deleteButton"> Delete </button>
</form>
<div id="deleteResultMsg"></div>

<br><hr><br>

<h2>Charities Search</h2>
<div id="searchContainer">
    <div id="conditionsContainer">
        <div class="condition-row" data-row-index="0">
            <select class="attribute-select">
                <option value="CharityID">Charity ID</option>
                <option value="Name">Name</option>
                <option value="Address">Address</option>
            </select>
            <select class="operator-select">
                <option value="=">=</option>
                <option value=">">> </option>
                <option value="<"> <</option>
                <option value="!=">!=</option>
            </select>
            <input type="text" class="value-input" placeholder="Enter value">
            <button class="remove-condition" style="display:none;">-</button>
        </div>
    </div>
    <div class="search-controls">
        <button id="addAndConditionBtn">Add AND Clause</button>
        <button id="addOrConditionBtn">Add OR Clause</button>
        <button id="searchBtn">Search</button>
    </div>
</div>
<div id="searchResultContainer">
    <table id="searchResultTable">
        <thead>
        <tr>
            <th>Charity ID</th>
            <th>Name</th>
            <th>Address</th>
        </tr>
        </thead>
        <tbody id="searchResultBody">
        </tbody>
    </table>
</div>
<div id="searchMessage"></div>

<br><hr><br>

<h2> Projection Charity </h2>
<form id="projectionForm">
    <label><input type="checkbox" name="attributes" value="CharityID"> CharityID</label><br>
    <label><input type="checkbox" name="attributes" value="Address"> Address</label><br>
    <label><input type="checkbox" name="attributes" value="Name"> Name</label><br>
    <button type="submit" id="submitProjection">Submit</button>
</form>
<div id="projectionResultMsg"></div>
<br><hr><br> <!-- ========================================================================= -->
<! -- JOINNNNN with FOODID return, SINNUM and CONTACT NUM (of people who donated food with this foodID) -->
<h2>Recipients by Food Item</h2>
<form id="foodRecipientsForm">
    <label for="foodIDInput">Food ID:</label>
    <input
            type="number"
            id="foodIDInput"
            placeholder="Enter Food ID"
            required
            min="1"
    >
    <button type="submit">Find Recipients</button>
</form>

<div id="recipientsResultContainer">
    <table id="recipientsTables">
        <thead>
        <tr>
            <th>SIN Number</th>
            <th>Contact Number</th>
        </tr>
        </thead>
        <tbody id="recipientsTableBody">

        </tbody>
    </table>
</div>

<div id="foodRecipientsMessage"></div>

<br><hr><br> <!-- ========================================================================= -->

<h2>Recipient Count by Age</h2>
<div id="ageCountQueryContainer">
    <button id="runAgeCountQuery">Count Recipients by Age</button>
</div>
<div id="ageCountResultContainer">
    <table id="ageCountResultTable">
        <thead>
        <tr>
            <th>Age</th>
            <th>Recipient Count</th>
        </tr>
        </thead>
        <tbody id="ageCountResultBody">

        </tbody>
    </table>
</div>
<div id="ageCountQueryMessage"></div>

<br><hr><br>

<h2>Events with Lowest Average Recipient Age</h2>
<div>
    <button id="lowestAgeEvent">Find Events with Lowest Average Age</button>
</div>
<div>
    <table>
        <thead>
        <tr>
            <th>Event ID</th>
            <th>Event Name</th>
            <th>Average Recipient Age</th>
        </tr>
        </thead>
        <tbody id="lowestAgeEventBody">

        </tbody>
    </table>
</div>
<div id="lowestAgeEventmsg"></div>

<br><hr><br>

<h2>What events have 2 or more recipients? Click to find out! </h2>
<div id="aggregationQueryContainer">
    <button id="runAggregationQuery">
        Find Events with 5 or More Recipients
    </button>
</div>

<div id="aggregationResultContainer">
    <table id="aggregationResultTable">
        <thead>
        <tr>
            <th>Event ID</th>
            <th>Average Age</th>
            <th>Total Recipients</th>
        </tr>
        </thead>
        <tbody id="aggregationResultBody">

        </tbody>
    </table>
</div>

<div id="aggregationQueryMessage"></div>

<br><hr><br>


<h2> Division: Find Contact Number of Recipients Attended All Donation Event </h2>
<button id="divisionButton">Search</button><br><br>
<h2>Result</h2>
<table id="resultTable" border="1">
    <thead>
    <tr>
        <th>ContactNum</th>
    </tr>
    </thead>
    <tbody>

    </tbody>
</table>

<!-- ===================================================================================== -->
<!-- External JavaScript file that contains the functionality/logic for the operations above. -->
<script src="scripts.js"></script>
</body>
</html>